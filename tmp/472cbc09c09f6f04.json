{"text":"Comandos criados com o intuito de facilitar o processo de mudança das alíquotas das operações fiscais, sem precisar passar uma a uma.Rodar o select abaixo para verificar as operações envolvidas na alteração.SELECTREGRA.CD_EMPRESA, REGRA.CD_OPERACAO, OP.DS_OBSOPERACAO, CD_IMPOSTO, REGRA.CD_SITTRIBUTARIA, PC_ALIQUOTA, PC_BASE, DS_FORMULABASE, DS_FORMULA, PC_DIFERIMENTOFROM FSOP_OPERACAOREGRAIMPOSTO AS REGRAINNER JOIN FSOP_OPERACAO AS OP ON (OP.CD_EMPRESA = REGRA.CD_EMPRESA AND OP.CD_OPERACAO = REGRA.CD_OPERACAO)WHERE(REGRA.CD_OPERACAO LIKE '5%' OR REGRA.CD_OPERACAO LIKE '1%') ANDCD_IMPOSTO IN ('ICMS', 'ICMSST', 'ICMSSTRET', 'ICMSEFET', 'ICMSSUB') ANDPC_ALIQUOTA = '17,5'OBSERVAR SE O \"PC_DIFERIMENTO\" É O PADRÃO DO DIFERIMENTO DE 31,4286. CASO NÃO FOR DEVE-SE ACIONAR O CLIENTE E QUESTIONAR QUAL O NOVO PERCENTUAL DE DIFERIMENTO.OBSERVAR TAMBÉM AS FÓRMULAS PARA VERIFICAR SE NÃO TEM NENHUM VALOR FIXO RELACIONADO AO PERCENTUAL DE ICMS OU DO DIFERIMENTO. SE HOUVER DEVE-SE ENTRAR NAS OPERAÇÕES E ALTERAR MANUALMENTE.Tendo feito a análise, rodar os comandos abaixo, nos quais irão mudar a alíquota de 17,5% para 17% e atualizar também os percentuais de diferimento (se for o percentual padrão de 31,4286%).UPDATE FSOP_OPERACAOREGRAIMPOSTOSET PC_ALIQUOTA = '17',USUA_MODIFIC = 'AVANT_ICMS',DATA_MODIFIC = GETDATE()WHERE(CD_OPERACAO LIKE '5%' OR CD_OPERACAO LIKE '1%') ANDCD_IMPOSTO IN ('ICMS', 'ICMSST', 'ICMSSTRET', 'ICMSEFET', 'ICMSSUB') ANDPC_ALIQUOTA = '17,5'UPDATE FSOP_OPERACAOREGRAIMPOSTOSET PC_DIFERIMENTO = '29.4117',USUA_MODIFIC = 'AVANT_ICMS',DATA_MODIFIC = GETDATE()WHERE(CD_OPERACAO LIKE '5%' OR CD_OPERACAO LIKE '1%') ANDCD_IMPOSTO IN ('ICMS') ANDPC_DIFERIMENTO LIKE '31.42%'Acessar o painel de controle no módulo fiscal para alterar a alíquota interna do estado.Após todo o processo rodar o recálculo dos pedidos de venda em aberto para atualizar o cálculo dos impostos.Não informar período.Situações: Bloqueado, Liberado, Faturado ParcialNaturezas fiscais que começam com 5."}